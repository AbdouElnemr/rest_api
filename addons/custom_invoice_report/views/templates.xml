<odoo>
    <data>

        <record id="paperformat_portrait" model="report.paperformat">
            <field name="name">Portrait format for pdf</field>
            <field name="default" eval="True"/>
            <field name="format">A4</field>
            <field name="page_height">0</field>
            <field name="page_width">0</field>
            <field name="orientation">Landscape</field>
            <field name="margin_top">0</field>
            <field name="margin_bottom">10</field>
            <field name="margin_left">3</field>
            <field name="margin_right">3</field>
            <field name="header_line" eval="False"/>
            <field name="header_spacing">41</field>
            <field name="dpi">80</field>
        </record>

        <record id="account_invoices_new" model="ir.actions.report">
            <field name="name">Invoices II</field>
            <field name="model">account.move</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">custom_invoice_report.report_invoice_with_payments_new</field>
            <field name="report_file">custom_invoice_report.report_invoice_with_payments_new</field>
            <field name="print_report_name">(object._get_report_base_filename())</field>
            <field name="attachment">(object.state == 'posted') and ((object.name or 'INV').replace('/','_')+'.pdf')</field>
            <field name="binding_model_id" ref="account.model_account_move"/>
            <field name="binding_type">report</field>
            <field name="paperformat_id" ref="custom_invoice_report.paperformat_portrait"/>
            <field name="groups_id" eval="[(4, ref('account.group_account_invoice')),
                                            (4, ref('account.group_account_readonly'))]"/>
        </record>

        <template id="report_invoice_document_new">
            <t t-call="web.external_layout">
                <t t-set="o" t-value="o.with_context(lang=lang)" />
<!--                <t t-set="address">-->
<!--                    <address t-field="o.partner_id" t-options='{"widget": "contact", "fields": ["address", "name"], "no_marker": True}' />-->
<!--                    <div t-if="o.partner_id.vat" class="mt16">-->
<!--                        <t t-if="o.company_id.country_id.vat_label" t-esc="o.company_id.country_id.vat_label" id="inv_tax_id_label"/>-->
<!--                        <t t-else="">Tax ID</t>: <span t-field="o.partner_id.vat"/></div>-->
<!--                </t>-->
                <style>

                    .custom_table tr, .custom_table tr td, .custom_table tr th{
                                border:2px solid #000;
                    }
                    .custom_table{
                                border:2px solid #000;
                                font-size:13px;
                                direction:ltr;
                                table-layout:fixed;
                                width:100%;
                    }
                </style>
                <div class="page">

                    <table class="table table-sm table-bordered custom_table p-0 m-0">
                            <colgroup>
                                <col width="5%"/><col width="5%"/>
                                <col width="5%"/><col width="5%"/>
                                <col width="5%"/><col width="5%"/>
                                <col width="5%"/><col width="5%"/>
                                <col width="5%"/><col width="5%"/>
                                <col width="5%"/><col width="5%"/>
                                <col width="5%"/><col width="5%"/>
                                <col width="5%"/><col width="5%"/>
                                <col width="5%"/><col width="5%"/>
                                <col width="5%"/><col width="5%"/>
                            </colgroup>
                            <tr>
                                <th colspan="5" rowspan="7">
                                    <img t-if="o.company_id.logo" t-att-src="image_data_uri(o.company_id.logo)" style="max-height: 70px;"/>

                                    <span t-field="o.company_id.name"/><br/>
                                    <span t-field="o.company_id.name_ar"/><br/>
                                    <span>TRN - رقم ضريبي :</span>
                                    <b t-field="o.company_id.vat"/><br/>
                                    <b>P.O Box </b><b t-field="o.company_id.po_box"/><br/>
                                    <b>Address: </b>
                                    <b t-field="o.company_id.street"/>,
                                    <b t-field="o.company_id.street2"/>,
                                    <b t-field="o.company_id.city"/>,
                                    <b t-field="o.company_id.state_id.name"/>

<!--                                    <span class="text-right">xx</span>-->

                                </th>
                                <th colspan="15">
                                    <center style="font-weight:bold;font-size:20px;line-height:1" >TAX INVOICE - فاتورة ضريبية</center>
                                </th>
                            </tr>
                            <tr>
                                <th colspan="5" rowspan="6">
                                    <b>Invoice No.</b><br/>
                                    <span>Customer Code: <span t-field="o.partner_id.name"/></span><br/>
                                    <span>Name: <span t-field="o.partner_id.name"/></span><br/>
                                    <span>Address:
                                        <span t-field="o.partner_id.street"/>,
                                        <span t-field="o.partner_id.street2"/>,
                                        <span t-field="o.partner_id.city"/>,
                                        <span t-field="o.partner_id.state_id.name"/>
                                    </span><br/>
                                    <span>Tel: <span t-field="o.partner_id.email"/></span><br/>
                                    <span>Fax: <span t-field="o.partner_id.email"/></span><br/>
                                    <span>Contact Name</span><br/>
                                    <span>Mobile: <span t-field="o.partner_id.mobile"/></span><br/>
                                    <span>Email: <span t-field="o.partner_id.email"/></span>
                                </th>
                                <th colspan="1" rowspan="6"/>
                                <th colspan="3">
                                    <span>Date: <span t-field="o.invoice_date"/></span>
                                </th>
                                <th colspan="3">
                                    <span>Number: <span t-field="o.name"/></span>
                                </th>
                                <th colspan="3">
                                    <span>Currency: <span t-field="o.currency_id.name"/></span>
                                </th>
                            </tr>
                            <tr>
                                <th colspan="4">
                                    <span>Packing List Ref:</span>
                                </th>
                                <th colspan="5">
                                    <span>Shipping Date: </span>
                                </th>
                            </tr>
                            <tr>
                                <th colspan="4">
                                    <span>Cust. Ref.:</span>
                                </th>
                                <th colspan="5" rowspan="2">
                                    <span>Shipping Details: </span>
                                </th>
                            </tr>
                            <tr>
                                <th colspan="4">
                                    <span>Ref. Date: </span>
                                </th>
                            </tr>
                            <tr>
                                <th colspan="9">
                                    <span>Shipping Instruction:</span>
                                </th>
                            </tr>
                            <tr>
                                <th colspan="9">
                                    <span>Payment Terms: <span t-field="o.invoice_payment_term_id"/></span>
                                </th>
                            </tr>
<!--                            <tr>-->
<!--                                <th colspan="2">x</th>-->
<!--                                <th colspan="3">x</th>-->
<!--                                <th colspan="2">x</th>-->
<!--                                <th colspan="3">x</th>-->
<!--                                <th colspan="2">x</th>-->
<!--                                <th colspan="3">x</th>-->
<!--                            </tr>-->
<!--                            <tr>-->
<!--                                <th colspan="2">x</th>-->
<!--                                <th colspan="3">x</th>-->
<!--                                <th colspan="2">x</th>-->
<!--                                <th colspan="3">x</th>-->
<!--                                <th colspan="2">x</th>-->
<!--                                <th colspan="3">x</th>-->
<!--                            </tr>-->
                    </table>
                    <br/>
                    <br/>
                    <br/>
                    <table class="table table-sm table-bordered custom_table p-0 m-0">
                            <colgroup>
                                <col width="2%"/><col width="5%"/>
                                <col width="5%"/><col width="5%"/>
                                <col width="5%"/><col width="5%"/>
                                <col width="8%"/><col width="5%"/>
                                <col width="5%"/><col width="5%"/>
                                <col width="5%"/><col width="5%"/>
                                <col width="5%"/><col width="5%"/>
                                <col width="5%"/><col width="5%"/>
                                <col width="5%"/><col width="5%"/>
                                <col width="5%"/><col width="5%"/>
                            </colgroup>
                        <thead>
                            <tr>
                                <th colspan="1" class="text-left"><span>#</span></th>
                                <th colspan="2" class="text-left"><span>Item</span></th>
                                <th colspan="2" class="text-left"><span>Type</span></th>
                                <th colspan="2" class="text-left"><span>Description</span></th>
                                <th colspan="1" class="text-left"><span>Origin</span></th>
                                <th colspan="1" class="text-left"><span>Brand</span></th>
                                <th colspan="1" class="text-left"><span>Color</span></th>
                                <th colspan="1" class="text-left"><span>Size</span></th>
                                <th colspan="1" class="text-left"><span>Qty</span></th>
                                <th colspan="1" class="text-left"><span>Price</span></th>
                                <th colspan="1" class="text-left"><span>Amount</span></th>
                                <th colspan="1" class="text-left"><span>Disc.%</span></th>
                                <th colspan="1" class="text-left"><span>Disc. Amt</span></th>
                                <th colspan="1" class="text-left"><span>Taxable Amt</span></th>
                                <th colspan="1" class="text-left"><span>Tax Code</span></th>
                                <th colspan="1" class="text-left"><span>Tax Amt</span></th>
                                <th colspan="1" class="text-left"><span>Total</span></th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-set="current_subtotal" t-value="0"/>
                            <t t-set="qty_tot" t-value="0"/>
                            <t t-set="amount_tot" t-value="0"/>
                            <t t-set="discount_tot" t-value="0"/>
                            <t t-set="discount_amount_tot" t-value="0"/>
                            <t t-set="taxable_tot" t-value="0"/>
                            <t t-set="tax_amount_tot" t-value="0"/>
                            <t t-set="total_tot" t-value="0"/>
                            <t t-set="lines" t-value="o.invoice_line_ids.sorted(key=lambda l: (-l.sequence, l.date, l.move_name, -l.id), reverse=True)"/>
                            <t t-set="seq" t-value="0"/>
                            <t t-foreach="lines" t-as="line">

                                <t t-set="seq" t-value="seq+1"/>
                                <t t-set="qty_tot" t-value="qty_tot+line.quantity"/>
                                <t t-set="amount_tot" t-value="amount_tot+line.price_subtotal"/>
                                <t t-set="discount_tot" t-value="discount_tot+line.discount"/>
                                <t t-set="discount_amount_tot" t-value="discount_amount_tot+line.line_discount_amount"/>
                                <t t-set="taxable_tot" t-value="taxable_tot+line.price_subtotal"/>
                                <t t-set="tax_amount_tot" t-value="tax_amount_tot+line.line_tax_amount"/>
                                <t t-set="total_tot" t-value="total_tot+line.price_total"/>

                                <t t-set="current_subtotal" t-value="current_subtotal + line.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded"/>
                                <t t-set="current_subtotal" t-value="current_subtotal + line.price_total" groups="account.group_show_line_subtotals_tax_included"/>
                                <tr >
                                    <td colspan="1"><span t-esc="seq"/></td>
                                    <td colspan="2"><span t-field="line.product_id.name"/></td>
                                    <td colspan="2"><span t-field="line.product_id.type"/></td>
                                    <td colspan="2"><span t-field="line.name" t-options="{'widget': 'text'}"/></td>
                                    <td colspan="1"><span t-field="line.product_id.origin_char"/></td>
                                    <td colspan="1"><span t-field="line.product_id.brand_char"/></td>
                                    <td colspan="1"><span t-field="line.product_id.color_char"/></td>
                                    <td colspan="1"><span t-field="line.product_id.size_char"/></td>
                                    <td colspan="1"><span t-field="line.quantity"/></td>
                                    <td colspan="1"><span t-field="line.price_unit"/></td>
                                    <td colspan="1"><span t-field="line.price_subtotal"/></td>
                                    <td colspan="1"><span t-field="line.discount"/></td>
                                    <td colspan="1"><span t-field="line.line_discount_amount"/></td>
                                    <td colspan="1"><span t-field="line.price_subtotal"/></td>
                                    <td colspan="1"><span /></td>
                                    <td colspan="1"><span t-field="line.line_tax_amount"/></td>
                                    <td colspan="1"><span t-field="line.price_total"/></td>
                                </tr>
                            </t>
                            <tr>
                                <td colspan="11">
                                    <span>Amount In Words: </span>
                                    <span t-esc="o.compute_amount_in_word(o.amount_total)"/>
                                </td>
                                <td colspan="1"><span t-esc="qty_tot"/></td>
                                <td colspan="1"><span /></td>
                                <td colspan="1"><span t-esc="amount_tot"/></td>
                                <td colspan="1"><span t-esc="discount_tot"/></td>
                                <td colspan="1"><span t-esc="discount_amount_tot"/></td>
                                <td colspan="1"><span t-esc="taxable_tot"/></td>
                                <td colspan="1"><span /></td>
                                <td colspan="1"><span t-esc="tax_amount_tot"/></td>
                                <td colspan="1"><span t-esc="total_tot"/></td>
                            </tr>
                        </tbody>
                    </table>

                </div>
            </t>
        </template>

        <template id="report_invoice_with_payments_new">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-set="lang" t-value="o.partner_id.lang"/>
                    <t t-set="print_with_payments" t-value="True"/>
                    <t t-call="custom_invoice_report.report_invoice_document_new" t-lang="lang"/>
                </t>
            </t>
        </template>


    </data>
</odoo>